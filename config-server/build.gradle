/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */
plugins {
    id 'application'
    id 'org.springframework.boot' version '2.6.6'
//    id "com.github.johnrengelman.shadow" version "7.1.2"
    id "com.github.johnrengelman.shadow" version "6.1.0"
    id 'io.spring.dependency-management' version '1.0.12.RELEASE'
    id 'java'
}
application {
    mainClass = "com.teamC.config.ConfigServerApplication"
}
mainClassName = "com.teamC.config.ConfigServerApplication"
ext {
    set('springCloudVersion', "2021.0.1")
    set('javaVersion', 11)
}
compileJava{
    sourceCompatibility("${javaVersion}")
    targetCompatibility("${javaVersion}")
}
apply plugin: "io.spring.dependency-management"
apply plugin: 'com.github.johnrengelman.shadow'
shadowJar {
    mergeServiceFiles()

}
dependencyManagement {
    imports {
        mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
    }
}
repositories {
    mavenCentral()
    maven { url 'https://repo.spring.io/milestone' }
    maven { url 'https://repo.spring.io/snapshot' }
}
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.cloud:spring-cloud-config-server'
/*
    implementation 'org.springframework.cloud:spring-cloud-config-server'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
*/
//            {
//        exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
//    }
}
//configurations {
//    all*.exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
//}
//create a single Jar with all dependencies
task fatJar(type: Jar) {
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    manifest {
        attributes 'Implementation-Title': 'Gradle Jar File Example',
//                'Implementation-Version': version,
                'Main-Class': 'com.teamC.config.ConfigServerApplication'
    }
    archiveBaseName = project.name + '-all'
    //duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    from { configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) } } {
//        exclude 'META-INF/MANIFEST.MF'
        exclude 'META-INF/*.SF'
        exclude 'META-INF/*.DSA'
        exclude 'META-INF/*.RSA'
    }
    with jar
}
description = 'config-server'
/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */
//plugins {
//    id 'application'
//    id 'org.springframework.boot' version '2.6.6'
//    id 'io.spring.dependency-management' version '1.0.12.RELEASE'
//    id 'java'
//}
//
//apply plugin: "io.spring.dependency-management"
//apply plugin: "java"
//
//group = 'com.teamC'
//version = '0.0.1-SNAPSHOT'
//sourceCompatibility = '11'
//
//
//ext {
//    set('springCloudVersion', "2021.0.1")
//}
//repositories {
//    mavenCentral()
//    maven { url 'https://repo.spring.io/milestone' }
//    maven { url 'https://repo.spring.io/snapshot' }
//}
//
//dependencyManagement {
//    imports {
//        mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
//    }
//}
//
//bootJar {
//    archiveClassifier = ''
//}
//
//dependencies {
//    implementation       (
//            'org.springframework.cloud:spring-cloud-config-server',
//            'org.springframework.boot:spring-boot-starter'
//    )
//
//}
//
//jar {
//    manifest {
//        attributes(
//                'Main-Class': 'com.teamC.config.ConfigServerApplication'
//        )
//    }
//}
//application {
//    mainClass = "com.teamC.config.ConfigServerApplication"
//}
//
//task fatJar(type: Jar) {
//    manifest {
//        attributes 'Implementation-Title': 'Gradle Jar File Example',
//                'Implementation-Version': version,
//                'Main-Class': 'com.teamC.config.ConfigServerApplication'
//    }
//    baseName = project.name + '-all'
//    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
//    with jar
//}
//
//artifacts {
//    archives fatJar
//}
//
//description = 'config-server'
//
//